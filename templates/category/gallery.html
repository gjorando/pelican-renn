{% extends "base.html" %}
{% if nsfw and CATEGORY_CONTEXT.nsfw %}
    {% set page_title = CATEGORY_CONTEXT.nsfw.page_title or CATEGORY_CONTEXT.page_title %}
    {% set CATEGORY_CONTEXT = namespace(CATEGORY_CONTEXT.nsfw) %}
    {% set CATEGORY_CONTEXT.page_title = page_title %}
{% endif %}

{% block title %}{{ SITENAME|striptags }} - {{ CATEGORY_CONTEXT.page_title }}{% endblock title %}

{% block header %}
    <h1>{{ CATEGORY_CONTEXT.page_title }}</h1>
    <p>{{ CATEGORY_CONTEXT.page_desc }}</p>
{% endblock header %}

{% block content %}
    <section>
        <ul class="gallery">
            {% for article in articles_page.object_list %}
                {%  if nsfw or "nsfw" not in article.metadata.tags %}
                    <li class="gallery-element" style="background: no-repeat url('{{ SITE_URL }}/{{ article.metadata.img }}'), var(--fg-color); background-size: cover;">
                        {% if "nsfw" in article.metadata.tags %}
                            <div class="nsfw">NSFW</div>
                        {% endif %}
                        <a href="{{ SITEURL }}/{{ article.url }}">
                            <h3>{{ article.title }}</h3>
                        </a>
                    </li>
                {% else %}
                    <li class="gallery-element" style="background: var(--fg-color);">
                    <a href="#">
                        <h3>{{ _("Je me demande ce que ce trou cache") }}</h3>
                    </a>
                </li>
                {% endif %}
            {% endfor %}
        </ul>
    </section>
    {% if articles_page.has_other_pages() %}
        {% include "pagination.html" %}
    {% endif %}
{% endblock content %}